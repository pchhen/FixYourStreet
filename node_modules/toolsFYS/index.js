var express = require('express'),
  router = express.Router(),
  mongoose = require('mongoose'),
  Tag = mongoose.model('Tag'),
  User = mongoose.model('User');

module.exports = {
  // Very Basic authentification system
  CheckAuthorization: function (req, res, next){
    User.findById(req.get("X-USERID"), function(err, user) {
      if (err) {
          res.status(500).send(err);
          return;
      } else if (!user) {
          res.status(404).send('User not found');
          return;
      }
      else{
        if(user.password != req.get("X-USERHASH")){
          res.status(403).send('User not authorized');
          return;
        }
      }
      req.userRole = user.role;
      next();
    });
  }
};
